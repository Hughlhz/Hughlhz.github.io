<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Precious things are very few in this world, that is the reason there is just one you.">
<meta property="og:type" content="website">
<meta property="og:title" content="Hughes&#39;Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Hughes&#39;Blog">
<meta property="og:description" content="Precious things are very few in this world, that is the reason there is just one you.">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Hughes'Blog</title>
  








<meta name="generator" content="Hexo 5.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hughes'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/reverse_data3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/reverse_data3/" itemprop="url">（转载）数据逆向分析(3)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T15:10:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>struct是由一系列具有相同类型或不同类型的数据构成的数据集合，也叫结构。它的实现方法上和数组是一样的，即每一个成员的访问是直接寻址方式。唯一的区别是，为了提高访问效率，成员无论类型为何，编译器将它们按照4字节对齐。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">eg：struct test</span><br><span class="line"></span><br><span class="line">       &#123;</span><br><span class="line"></span><br><span class="line">            char str;</span><br><span class="line"></span><br><span class="line">            int i;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">       test a&#x3D;&#123;&#39;A&#39;,0&#125;;</span><br><span class="line"></span><br><span class="line">debug:</span><br><span class="line"></span><br><span class="line">0041139E  mov         byte ptr [ebp-0Ch],41h &#x2F;&#x2F;4字节对齐</span><br><span class="line">004113A2  mov         dword ptr [ebp-8],0</span><br></pre></td></tr></table></figure>


<h4 id="同样的尴尬"><a href="#同样的尴尬" class="headerlink" title="同样的尴尬"></a>同样的尴尬</h4><p>和数组一样，直接从二进制代码上判断结构体边界，并且它比数组的判断更难。尤其是自定义结构体。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. struct TimeCount</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">     time_t Begin;</span><br><span class="line"></span><br><span class="line">     time_t End;</span><br><span class="line"></span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   TimeCount clock;&#x2F;&#x2F;很好的书写习惯</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">2. tme_t Begin,End;&#x2F;&#x2F;稍微懒一点</span><br><span class="line"></span><br><span class="line">3. time_t a[2];&#x2F;&#x2F;太恶劣了</span><br></pre></td></tr></table></figure>

<p>这三个声明是等价的，struct的界定应该说很多时候是非常随意的，但是以下情况是必须准确判断：</p>
<pre><code>1. 变量是结构体数组时，如果不想还原的代码，写满屏幕的话，嘿嘿...



2. 以指针形式在函数间传递时，好在这种情况很少是自定义结构体，这使得我们通常可以借助OD、IDA帮你判断。出现自定义结构体时，绝大多数情况又是队列、二叉树等等，只要经验足够的话是不难的。

3.4字节对齐产生数据空隙时，这么容易判断的时候，有便宜不占是白痴。</code></pre>
<h4 id="附上大佬的Blog链接"><a href="#附上大佬的Blog链接" class="headerlink" title="附上大佬的Blog链接"></a>附上大佬的Blog链接</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yangbostar/article/list/2">https://blog.csdn.net/yangbostar/article/list/2</a>?</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/reverse_data2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/reverse_data2/" itemprop="url">（转载）数据逆向分析(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T15:00:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>在C语言中，字符串是由字符组成，单字符不是字符串，至少有两个字符组成，且结尾字符是’/0’。</p>
<p>例如：”ABCD” 内存中实际储存结构是 41H 42H 43H 44H 00H</p>
<p>字符串的寻址，依靠首字节进行寄存器相对寻址方式：</p>
<p>例如：访问”ABCD”中的第二字节，byte ptr [ebx+1]</p>
<p>正是因为字符串的首字节索引的寻址方式，因此字符串往往要与指针配合。在C语言中常见的，</p>
<p>例如：char *str=“ABCD”；//mov [xxxx],offset string “ABCD”</p>
<p>另一种常见的方式，是将字符串放在数组里，需要首字节地址时，在数组名前加”&amp;”伪装成指针。当然，存在数组里的字符串，自然可以按照数组的访问方式，比如 直接寻址。</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>数组其实和普通变量没什么区别，每一个成员都是分别通过直接寻址方式访问。</p>
<p>但只有一种情况例外，并且十分常见，即当索引号为变量时，使用相对寻址方式。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char a[4]&#x3D;&#123;&#39;A&#39;,&#39;A&#39;,&#39;A&#39;,&#39;&#x2F;0&#39;&#125;;</span><br><span class="line">for(int i&#x3D;0;i&lt;3;i++)</span><br><span class="line">a[i]+&#x3D;1;</span><br></pre></td></tr></table></figure>
<p>对应反汇编：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">char a[4]&#x3D;&#123;&#39;A&#39;,&#39;A&#39;,&#39;A&#39;,&#39;&#x2F;0&#39;&#125;;</span><br><span class="line">0041139E  mov         byte ptr [a],41h</span><br><span class="line">004113A2  mov         byte ptr [ebp-7],41h</span><br><span class="line">004113A6  mov         byte ptr [ebp-6],41h</span><br><span class="line">004113AA  mov         byte ptr [ebp-5],0</span><br><span class="line"></span><br><span class="line">for(int i&#x3D;0;i&lt;3;i++)</span><br><span class="line">004113AE  mov         dword ptr [i],0</span><br><span class="line">004113B5  jmp         wmain+40h (4113C0h)</span><br><span class="line">004113B7  mov         eax,dword ptr [i]</span><br><span class="line">004113BA  add         eax,1</span><br><span class="line">004113BD  mov         dword ptr [i],eax</span><br><span class="line">004113C0  cmp         dword ptr [i],3</span><br><span class="line">004113C4  jge         wmain+5Ah (4113DAh)</span><br><span class="line"></span><br><span class="line">a[i]+&#x3D;1;</span><br><span class="line">004113C6  mov         eax,dword ptr [i]</span><br><span class="line">004113C9  movsx       ecx,byte ptr a[eax]</span><br><span class="line">004113CE  add         ecx,1</span><br><span class="line">004113D1  mov         edx,dword ptr [i]</span><br><span class="line">004113D4  mov         byte ptr [a+edx],cl ;反汇编器上常写为mov byte ptr a[edx],cl</span><br><span class="line">004113D8  jmp         wmain+37h (4113B7h)</span><br></pre></td></tr></table></figure>


<h3 id="数组的尴尬"><a href="#数组的尴尬" class="headerlink" title="数组的尴尬"></a>数组的尴尬</h3><p>除了源码调试，由于数组不标记边界，提通过数据初始化不能判断数组的始末位置<br>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int i&#x3D;0;</span><br><span class="line">int a[3]&#x3D;&#123;1,2,3&#125;;</span><br><span class="line"></span><br><span class="line">OD反汇编结果：</span><br><span class="line"></span><br><span class="line">00412FFE   MOV DWORD PTR SS:[EBP-8],   0</span><br><span class="line">00413005   MOV DWORD PTR SS:[EBP-1C], 1</span><br><span class="line">0041300C   MOV DWORD PTR SS:[EBP-18], 2</span><br><span class="line">00413013   MOV DWORD PTR SS:[EBP-14], 3</span><br></pre></td></tr></table></figure>

<p>显然，只看初始化我们很容易错误还原为 int a[4]={0,1,2,3};</p>
<p>因此数组的边界判断，需要后续代码流程的辅助，因为数组通常都是同一类操作的集合。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/reverse_data1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/reverse_data1/" itemprop="url">（转载）数据逆向分析(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T14:40:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>做数据逆向分析最先应该区分数据是常量、变量，还是指针。可是作为二进制数据本身不会标记自己是什么，然而编译器将不同的的类别储存在不同的区域。</p>
<h3 id="变量数据应分为这两类："><a href="#变量数据应分为这两类：" class="headerlink" title="变量数据应分为这两类："></a>变量数据应分为这两类：</h3><h4 id="1-局部非静态变量："><a href="#1-局部非静态变量：" class="headerlink" title="1. 局部非静态变量："></a>1. 局部非静态变量：</h4><p>对于1KB以下的该种变量，一般都要放在栈区，那么它的寻址必然用到ebp寄存器来间接变址进行寻址。另外，有些编译器（比如gcc）出于优化考虑，也会用到esp寄存器。</p>
<h5 id="举例："><a href="#举例：" class="headerlink" title="举例："></a>举例：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">void fun()</span><br><span class="line">&#123;</span><br><span class="line"> int i&#x3D;0;</span><br><span class="line"> char a[5]&#x3D;&quot;AAAA&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;vc2005Debug版反汇编</span><br><span class="line"></span><br><span class="line">void fun()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------保护寄存器数据</span><br><span class="line">00411390  push        ebp </span><br><span class="line">00411391  mov         ebp,esp</span><br><span class="line">00411393  sub         esp,0E0h</span><br><span class="line">00411399  push        ebx </span><br><span class="line">0041139A  push        esi </span><br><span class="line">0041139B  push        edi </span><br><span class="line"></span><br><span class="line">---------------------为局部变量在栈区预留内存，以及vc编译器的添加防溢出措施</span><br><span class="line"></span><br><span class="line">0041139C  lea         edi,[ebp-0E0h]</span><br><span class="line">004113A2  mov         ecx,38h</span><br><span class="line">004113A7  mov         eax,0CCCCCCCCh</span><br><span class="line">004113AC  rep stos    dword ptr es:[edi]</span><br><span class="line">004113AE  mov  eax,dword ptr [___security_cookie (417000h)] &#x2F;&#x2F;研究溢出漏洞的人，</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;可以看一下蓝色代码，</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;通过在回调地址前，</span><br><span class="line"></span><br><span class="line">                  	&#x2F;&#x2F;添加安全码</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;使shellcode不可以覆盖</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;这里，否则异常</span><br><span class="line">004113B3  xor           eax,ebp</span><br><span class="line">004113B5  mov         dword ptr [ebp-4],eax </span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;这是vs2005的新特性，</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;你想能出破解方案吗？</span><br><span class="line"></span><br><span class="line">-------------------------------------------------</span><br><span class="line"></span><br><span class="line">int i&#x3D;0</span><br><span class="line"></span><br><span class="line">004113B8  mov         dword ptr [ebp-0Ch],0</span><br><span class="line"> char a[5]&#x3D;&quot;AAAA&quot;;</span><br><span class="line">004113BF  mov         eax,dword ptr [string &quot;AAAA&quot; (41563Ch)]</span><br><span class="line">004113C4  mov         dword ptr [ebp-1Ch],eax</span><br><span class="line">004113C7  mov         cl,byte ptr ds:[415640h]</span><br><span class="line">004113CD  mov         byte ptr [ebp-18h],cl</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">004113D0 push edx</span><br><span class="line">004113D1 mov ecx,ebp</span><br><span class="line">004113D3 push eax</span><br><span class="line">004113D4 lea edx,[ (4113F4h)]</span><br><span class="line">004113DA call @ILT+140(@_RTC_CheckStackVars@8) (411091h)</span><br><span class="line">004113DF pop eax</span><br><span class="line">004113E0 pop edx</span><br><span class="line">004113E1 pop edi</span><br><span class="line">004113E2 pop esi</span><br><span class="line">004113E3 pop ebx</span><br><span class="line">004113E4 mov ecx,dword ptr [ebp-4]</span><br><span class="line">004113E7 xor ecx,ebp</span><br><span class="line">004113E9 call @ILT+25(@__security_check_cookie@4) (41101Eh)</span><br><span class="line">004113EE mov esp,ebp</span><br><span class="line">004113F0 pop ebp</span><br><span class="line">004113F1 ret  </span><br></pre></td></tr></table></figure>

<h4 id="2-全局变量、局部静态变量："><a href="#2-全局变量、局部静态变量：" class="headerlink" title="2. 全局变量、局部静态变量："></a>2. 全局变量、局部静态变量：</h4><p>它们统一储存在数据节，因为它们的实现方式是一样的，都是直接寻址方式来寻址，只是全局变量，在所有区域均可访问，而局部静态变量只能在函数内部访问。</p>
<h5 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">char a[5]&#x3D;&quot;AAAA&quot;;</span><br><span class="line">void fun()</span><br><span class="line">&#123;</span><br><span class="line"> static int i;</span><br><span class="line"> i&#x3D;0;</span><br><span class="line"> a[0]&#x3D;&#39;b&#39;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> void fun()</span><br><span class="line">&#123;</span><br><span class="line">00411390  push        ebp </span><br><span class="line">00411391  mov         ebp,esp</span><br><span class="line">00411393  sub         esp,0C0h</span><br><span class="line">00411399  push        ebx </span><br><span class="line">0041139A  push        esi </span><br><span class="line">0041139B  push        edi </span><br><span class="line">0041139C  lea         edi,[ebp-0C0h]</span><br><span class="line">004113A2  mov         ecx,30h</span><br><span class="line">004113A7  mov         eax,0CCCCCCCCh</span><br><span class="line">004113AC  rep stos    dword ptr es:[edi] &#x2F;&#x2F;由于没有使用堆栈，编译器没有添加防溢出措施</span><br><span class="line"> static int i;</span><br><span class="line"> i&#x3D;0;</span><br><span class="line">004113AE  mov         dword ptr [41719Ch],0</span><br><span class="line"> a[0]&#x3D;&#39;b&#39;;</span><br><span class="line">004113B8  mov         byte ptr [417034h],62h </span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">004113BF pop edi</span><br><span class="line">004113C0 pop esi</span><br><span class="line">004113C1 pop ebx</span><br><span class="line">004113C2 mov esp,ebp</span><br><span class="line">004113C4 pop ebp</span><br><span class="line">004113C5 ret</span><br></pre></td></tr></table></figure>




<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>常量和全局变量、静态变量实现方法使一样的，使用直接寻址，但区别是：只能读、不可写。<br>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. mov eax, [417034h]</span><br><span class="line"></span><br><span class="line">2. cmp eax, [417034h]</span><br></pre></td></tr></table></figure>


<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>指针可以当做是存储地址的变量，它即可以是全局变量，也可以是局部非静态变量，但与普通变量的区别是:”初始化时使用offset或lea，使用指向内容时二次寻址”。</p>
<p>举例：初始化：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.mov [417034h],offset “AAAA”&#x2F;&#x2F;全局指针</span><br><span class="line"></span><br><span class="line">2.lea   eax,ARRAY</span><br><span class="line"></span><br><span class="line">  mov [esp-4ch],eax&#x2F;&#x2F;局部指针</span><br><span class="line"></span><br><span class="line">使用：</span><br><span class="line"></span><br><span class="line">1.mov eax, [417034h]</span><br><span class="line"></span><br><span class="line">  mov edx, [eax]</span><br><span class="line"></span><br><span class="line">2.mov eax, [esp-4ch]</span><br><span class="line"></span><br><span class="line">  mov edx, [eax+i]&#x2F;&#x2F;指针可能指向的是数组</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;vc2005Debug版反汇编</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/ce_tg3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/ce_tg3/" itemprop="url">CE Tutorial Games--3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T14:20:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="CE-Tutorial-Games"><a href="#CE-Tutorial-Games" class="headerlink" title="CE Tutorial Games"></a>CE Tutorial Games</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/18/jmp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/18/jmp/" itemprop="url">跳转指令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-18T20:44:39+08:00">
                2019-10-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>为了防止遗忘，以及为了日后查找方便，记录一下跳转指令的条件以及其意义</p>
<h3 id="跳转指令"><a href="#跳转指令" class="headerlink" title="跳转指令"></a>跳转指令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ja 大于时跳转</span><br><span class="line">jae 大于等于</span><br><span class="line">jb 小于</span><br><span class="line">jbe 小于等于</span><br><span class="line">je 相等</span><br><span class="line">jna 不大于</span><br><span class="line">jnae 不大于或者等于</span><br><span class="line">jnb 不小于</span><br><span class="line">jnbe 不小于或等于</span><br><span class="line">jne 不等于</span><br><span class="line">jg 大于(有符号)</span><br><span class="line">jge 大于等于(有符号)</span><br><span class="line">jl 小于(有符号)</span><br><span class="line">jle 小于等于(有符号)</span><br><span class="line">jng 不大于(有符号)</span><br><span class="line">jnge 不大于等于(有符号)</span><br><span class="line">jnl 不小于</span><br><span class="line">jnle 不小于等于</span><br><span class="line">jns 无符号</span><br><span class="line">jnz 非零</span><br><span class="line">js 如果带符号</span><br><span class="line">jz 如果为零</span><br></pre></td></tr></table></figure>

<p>发生跳转时各标志寄存器的值<br><img src="/2019/10/18/jmp/1.png"></p>
<p>以及对应的指令字母的含义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a: above</span><br><span class="line">e: equal</span><br><span class="line">b: below</span><br><span class="line">n: <span class="keyword">not</span></span><br><span class="line">g: greater</span><br><span class="line">l: lower</span><br><span class="line">s: signed</span><br><span class="line">z: zero</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/16/ce_tg2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/16/ce_tg2/" itemprop="url">CE Tutorial Games--2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-16T19:00:20+08:00">
                2019-10-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##<br>参照文档：<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-915447-1-1.html">https://www.52pojie.cn/thread-915447-1-1.html</a><br>开始CE Tutorial Game 第三关的再次尝试。</p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>2D游戏就两个坐标，按照52某牛的说法，2D游戏一般是左负右正，上下的正负不一定。</p>
<p>先利用CE搜索到人物的坐标。首先选到单浮点数和未知初始值，多次移动人物再加上多次搜索后就可以确定一个值了，这个就是我们要找的横坐标。<br><img src="/2019/10/16/ce_tg2/1.png" alt="1"><br>这时候修改这个横坐标的值就可以让人物进行瞬移了.<br>配合上上篇Blog里修改变绿台阶数为12即可过关.<br>现在我们来找一下任务的纵坐标.<br>一般横纵坐标的值应该都放在同一个地方,所以我们可以试下查看横坐标在内存中的相邻区域.<br><img src="/2019/10/16/ce_tg2/2.png" alt="2"><br>然后选择以浮点方式查看内存,接着让人物跳跃、移动,就可以发现两个可疑数据<br><img src="/2019/10/16/ce_tg2/3.png" alt="3"><br>观察数据变化可以发现,横坐标在屏幕内的范围从左到右是(-1,1),纵坐标在屏幕内的变化范围从上到下是(-1,1)</p>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>接下来试下找到游戏里面的重力系统.</p>
<h4 id="2-1"><a href="#2-1" class="headerlink" title="2-1"></a>2-1</h4><p>重力可以改变纵坐标的值,所以我们查看下是什么改变纵坐标的值.<br><img src="/2019/10/16/ce_tg2/4.png" alt="4"><br>发现有两个指令对其进行修改,其中有一条指令在人物跳起来时不会写入数据.<br>猜测应该是第一条对纵坐标进行了修改.<br>进入内存查看,剔除掉和纵坐标无关的指令,剩下的代码由52大牛整理如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gtutorial-x86_64.exe+4048D - 48 8B 43 28           - mov rax,[rbx+28]</span><br><span class="line">gtutorial-x86_64.exe+40491 - F3 44 0F10 40 28      - movss xmm8,[rax+28] &#123; 读取 Y 坐标 &#125;</span><br><span class="line">gtutorial-x86_64.exe+40497 - 48 8B 43 28           - mov rax,[rbx+28]</span><br><span class="line">gtutorial-x86_64.exe+4049B - F3 0F5A 48 28         - cvtss2sd xmm1,[rax+28] &#123; 再次读取 Y 坐标 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404A0 - F3 0F5A 53 78         - cvtss2sd xmm2,[rbx+78] &#123; 读取 Y 速度 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404A5 - F2 0F2A C6            - cvtsi2sd xmm0,esi &#123; esi 是毫秒数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404A9 - F2 0F5E 05 AF382400   - divsd xmm0,[gtutorial-x86_64.exe+283D60] &#123; 除以 1000 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404B1 - F2 0F59 C2            - mulsd xmm0,xmm2 &#123; 速度乘时间 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404B5 - F2 0F5C C8            - subsd xmm1,xmm0 &#123; Y 坐标减去位移 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404B9 - F2 44 0F5A C9         - cvtsd2ss xmm9,xmm1 &#123; double 转 float &#125;</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">gtutorial-x86_64.exe+40506 - F3 44 0F11 48 28      - movss [rax+28],xmm9 &#123; 赋值给 [rax+28] &#125;</span><br></pre></td></tr></table></figure>

<p>感觉整个分析过程就是要甄别出真正有效的数据,然后找出他们的内在逻辑.</p>
<p>纵坐标的地址可以很容易找出: <code>[[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+28]+28</code>(他这里好像写错了)<br>根据分析,速度地址应该是 <code>[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+78</code><br>手动添加地址后我们就可以直接修改速度了,但是这个速度会变化,所以我们可以设置热键,让速度分别变为1和-1,这样就可以比较好地进行控制.<br>根据同样的道理,水平方向的速度我们也可以进行更改.</p>
<h4 id="2-2"><a href="#2-2" class="headerlink" title="2-2"></a>2-2</h4><p>这次来找重力加速度.<br>重力加速度会直接影响竖直方向上的速度,我们直接查看什么修改了竖直方向上的速度.<br><img src="/2019/10/16/ce_tg2/5.png" alt="5"><br>发现只有第二条指令会一直对速度修改,所以在内存中查看第二条指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gtutorial-x86_64.exe+40709 - F3 0F5A 43 78         - cvtss2sd xmm0,[rbx+78] &#123; 读取速度 &#125;</span><br><span class="line">gtutorial-x86_64.exe+4070E - F2 0F5C 05 52362400   - subsd xmm0,[gtutorial-x86_64.exe+283D68] &#123; 减去 0.1 &#125;</span><br><span class="line">gtutorial-x86_64.exe+40716 - F2 0F5A C0            - cvtsd2ss xmm0,xmm0 &#123; double 转 float &#125;</span><br><span class="line">gtutorial-x86_64.exe+4071A - F3 0F11 43 78         - movss [rbx+78],xmm0 &#123; 写入速度 &#125;</span><br></pre></td></tr></table></figure>
<p>这个机制蛮简单的,每次速度减0.1.</p>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>这次来找敌人的位置.<br>只要找到敌人的横坐标,它们的地址+4就是他们的纵坐标了.和搜索自己的坐标方法类似,很快可以搜索到他们的坐标.<br>直接锁定他们坐标的值,发现可以锁定,但是当12个台阶都亮起时,他们还是会飞去守门.<br>这时候查看什么对它们进行了写入,借用大牛的图:<br><img src="/2019/10/16/ce_tg2/6.png" alt="6"><br>直接将第五条指令nop掉,就可以对他们的坐标进行修改了.</p>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>这次来查找开门的指令.<br>开门和已经变绿的台阶数量有关系,那么我们先查看有什么访问了这个变量.<br>查看后发现只有一条指令堆积访问,于是查看它在内存中的位置,发现有几个有意思的判断:(还是摘自大牛整理的代码)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gtutorial-x86_64.exe+4098B - 48 63 93 88000000     - movsxd  rdx,dword ptr [rbx+00000088] &#123; 读取已变绿平台数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+40992 - 48 8B 43 30           - mov rax,[rbx+30]</span><br><span class="line">gtutorial-x86_64.exe+40996 - 48 85 C0              - test rax,rax</span><br><span class="line">gtutorial-x86_64.exe+40999 - 74 08                 - je gtutorial-x86_64.exe+409A3</span><br><span class="line">gtutorial-x86_64.exe+4099B - 48 8B 40 F8           - mov rax,[rax-08] &#123; [rax-08] 为平台数组最大下标 &#125;</span><br><span class="line">gtutorial-x86_64.exe+4099F - 48 83 C0 01           - add rax,01 &#123; 最大下标 + 1 即为总平台数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409A3 - 48 39 C2              - cmp rdx,rax &#123; 比较已变绿平台数和总平台数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409A6 - 7C 17                 - jl gtutorial-x86_64.exe+409BF</span><br><span class="line">gtutorial-x86_64.exe+409A8 - 48 8B 43 60           - mov rax,[rbx+60] &#123; 二级指针 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409AC - C6 40 18 00           - mov byte ptr [rax+18],00 &#123; 开门 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409B0 - C6 43 7D 01           - mov byte ptr [rbx+7D],01 &#123; 堵门 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409B4 - 48 8B 43 68           - mov rax,[rbx+68]</span><br><span class="line">gtutorial-x86_64.exe+409B8 - 48 89 83 80000000     - mov [rbx+00000080],rax</span><br><span class="line">gtutorial-x86_64.exe+409BF - 48 83 7B 28 00        - cmp qword ptr [rbx+28],00 &#123; 0 &#125;</span><br></pre></td></tr></table></figure>

<p>这里可以看到总台阶数并没有存在哪个变量里,而是由数组下标+1来表示.<br>我们可以推导出开门地址<code> [[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+60]+18</code><br>以及<code>[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+7D</code><br>这样直接修改开门地址为0,堵门地址也为0就可以过关了.</p>
<h4 id="内容太多了-下一篇Blog再来写破解碰撞检测的方法"><a href="#内容太多了-下一篇Blog再来写破解碰撞检测的方法" class="headerlink" title="内容太多了,下一篇Blog再来写破解碰撞检测的方法."></a>内容太多了,下一篇Blog再来写破解碰撞检测的方法.</h4>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/14/ce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/14/ce/" itemprop="url">初学CheatEngine的使用(内含CE Tutorial Games--1）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-14T15:00:20+08:00">
                2019-10-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="CheatEngine"><a href="#CheatEngine" class="headerlink" title="CheatEngine"></a>CheatEngine</h2><p>很早就接触过了CE修改器，当时是玩一些幼稚小游戏，然后用ce修改器修改金币和经验。不过也仅仅是接触，从来没有深入过，这次CNSS招新有道贪食蛇的题目(wtcl,还没写出来)，可以用CE调试,我就准备学下CE调试,然后刚刚好它有几个教程,这篇blog就来写下写CE教程题目的经历.<br>总共分为两部分,一个是Cheat Engine Tutorial,另一个是Cheat Engine Tutorial Games.</p>
<h2 id="Cheat-Engine-Tutorial"><a href="#Cheat-Engine-Tutorial" class="headerlink" title="Cheat Engine Tutorial"></a>Cheat Engine Tutorial</h2><p>这部分非常基础,然后基本上就是CE的基本用法.<br>第一关到第八关有手就行,然后第九关有一个点我没接触过,这里记录下来.<br>第九关是个小游戏,敌我双方各两个人,但是敌人伤害高血还厚,我们打不过,而过关的条件就是把敌人乃一组特.(如图)<br><img src="/2019/10/14/ce/1p.png" alt="第九关"><br>首先肯定是搜索血量,很容易搜到四个人的血量的地址.然后F6,查看是什么改写这个地址.查看之后发现改写的时候调用的是同一个函数(如图).</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/10/14/ce/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/14/diff_call/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/14/diff_call/" itemprop="url">三种call的简要区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-14T14:30:18+08:00">
                2019-10-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="stdcall-cdecl-fastcall的区别"><a href="#stdcall-cdecl-fastcall的区别" class="headerlink" title="__stdcall,__cdecl,__fastcall的区别"></a>__stdcall,__cdecl,__fastcall的区别</h2><p>Call_name | __stdcall | __cdecl | __fastcall<br>:-: | :-: | :-: | :-: | :-:<br>参数传递方式 | 右-&gt;左 压栈 | 右-&gt;左 压栈 | 左边开始的两个不大于4字节（DWORD）的参数分别放在ECX和EDX寄存器，其余的参数仍旧自右向左压栈传送<br>清理栈方式 | 被调用函数清理（即函数自己清理），多数据情况使用这个 | 调用者清理 | 被调用者清理<br>使用场合| WinAPI| C/C++ MFC默认方式 可变参数的时候使用|速度快<br>C编译修饰约定（它们均不改变输出函数名中的字符大小写）| 约定在输出函数名前加上一个下划线前缀，后面加上一个“@”符号和其参数的字节数，格式为_functionname@number|约定仅在输出函数名前加上一个下划线前缀，格式为_functionname|调用约定在输出函数名前加上一个“@”符号，后面也是一个“@”符号和其参数的字节数，格式为@functionname@number</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/06/re_if_else/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/re_if_else/" itemprop="url">反汇编——2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T16:30:18+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="反汇编——2"><a href="#反汇编——2" class="headerlink" title="反汇编——2"></a>反汇编——2</h3><p>这次学了if_else语句的反汇编<br>先是IF_ELSE语句的判断:<br><img src="/2019/10/06/re_if_else/1.png" alt="1"></p>
<p>看一个示例:<br><img src="/2019/10/06/re_if_else/4.png" alt="sample"></p>
<p>这段代码解释之后就是:<br><img src="/2019/10/06/re_if_else/2.png" alt="explaination1"></p>
<p><img src="/2019/10/06/re_if_else/3.png" alt="explaination2"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/06/re_stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/re_stack/" itemprop="url">反汇编——1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T14:30:18+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="反汇编——1"><a href="#反汇编——1" class="headerlink" title="反汇编——1"></a>反汇编——1</h3><p>看了陈曦学姐给的某某视频三期，收获非常多，非常感谢陈曦学姐！<br><img src="/2019/10/06/re_stack/3.png" alt="all"><br>这个是关于函数调用时的汇编代码</p>
<p><img src="/2019/10/06/re_stack/4.jpg" alt="参数的引入"><br>这个可以理解为引入参数</p>
<p><img src="/2019/10/06/re_stack/2.png" alt="堆栈平衡"><br>堆栈平衡:也就是说调用函数前后,堆栈是不发生变化的</p>
<p>附上一些当时手画的堆栈的图:<br><img src="/2019/10/06/re_stack/5.png" alt="1"><br><img src="/2019/10/06/re_stack/6.png" alt="1"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/">&lt;</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/">&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">42</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hughlhz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:hughes_lhz@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://sup3rgate.xyz/" title="Supergate" target="_blank">Supergate</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://47.95.203.90/" title="Weihongtao" target="_blank">Weihongtao</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hujiekang.top/" title="Hujiekang" target="_blank">Hujiekang</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://106.54.80.67/" title="Centrix" target="_blank">Centrix</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://47.100.137.92/" title="CjDuan" target="_blank">CjDuan</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.pushrbp.com" title="Cool" target="_blank">Cool</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
