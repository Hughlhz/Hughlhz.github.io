<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Precious things are very few in this world, that is the reason there is just one you.">
<meta property="og:type" content="website">
<meta property="og:title" content="Hughes&#39;Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hughes&#39;Blog">
<meta property="og:description" content="Precious things are very few in this world, that is the reason there is just one you.">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>Hughes'Blog</title>
  








<meta name="generator" content="Hexo 5.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hughes'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/27/breakpoint/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/27/breakpoint/" itemprop="url">下断方式总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-27T11:10:20+08:00">
                2019-10-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>现在就目前我知道的下断点的方法进行总结下</p>
<h4 id="1、根据API下断点"><a href="#1、根据API下断点" class="headerlink" title="1、根据API下断点"></a>1、根据API下断点</h4><p>根据API下断点有两种方法，一种是用Ctrl+G，然后输入想要断下的API，这个时候相关调用了API函数的地址就会变色，但是这样下的断点有时候没有用。<br>另一种根据API下断点的方式使用Ctrl+N，然后查看程序调用的所有API，然后键入想要断下的API（这个搜索栏有点奇怪，居然显示在OD的顶部），选中后F2下断就可以了。</p>
<h4 id="2、字符串断点"><a href="#2、字符串断点" class="headerlink" title="2、字符串断点"></a>2、字符串断点</h4><p>嗯，，这种方法在能搜到字符串的时候很有用，但是搜不到的时候你就自求多福吧。<br>操作起来非常简单，就是直接搜，不知道是Ascii还是Unicode就用智能搜索，搜到之后，选中然后回车，这时候可能和关键代码比较近了。</p>
<h4 id="3、内存断点"><a href="#3、内存断点" class="headerlink" title="3、内存断点"></a>3、内存断点</h4><p>内存端点就是跟踪关键数据的断点。<br>感觉这种断点和Cheat Engine的模式有点像.<br>下断的方法就是,在内存区域选中一段关键数据,就有点像CE里面你搜索到的关键数据,然后右键点击断点,出现内存访问和内存写入两个选项,顾名思义,选择内存访问时就是当你选中的这段数据被调用时,程序就会被断下来,而内存写入时则是当这个数据被修改时程序会被断下来,用过CE的话,就应该会发现这两个下断的方式和CE里面查找是什么指令访问或者写入了这块数据很相像.<br>这个下断的方式就很牛逼了,因为这样可以很容易找到关键代码部分hhh.<br>然后这个下断方式有一个小技巧,就是如果已知一些数据,可以直接Alt+M,然后在这里面搜索一直的数据,然后下断.比如有个程序的序列码是由你输入的ID生成的,那么这个时候,你输入的ID就可以直接搜索,这样得到的信息量就非常多.</p>
<h4 id="4、硬件断点"><a href="#4、硬件断点" class="headerlink" title="4、硬件断点"></a>4、硬件断点</h4><p>emm，本菜鸡还没遇到过。。。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/26/crackme001/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/26/crackme001/" itemprop="url">CrackMe---001</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-26T15:10:20+08:00">
                2019-10-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>正式开始写CrackMe160题。<br>下面是CM001的WriteUp。</p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>首先这个题目要求我们把Nag给干掉。<br>我想那好啊，直接根据API下断，把调用了MessageBoxA的地方直接NOP掉就完事了，结果一试才发现不对劲，这个调用的地方是系统领空，不是程序领空，不能直接NOP。<br>那接着能怎么办，老办法，搜索字符串。<br>搜索到后，回车来到代码部分，也没看见什么东西调用系统API，所以直接让程序执行到返回，然后把整个函数给NOP掉，这样级成功去除Nap了。</p>
<p>接着打开这个程序，发现它可以通过两种方式进行注册。一种是直接用序列码，另一种则是用ID和由ID生成的序列码注册。</p>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>先从简单的入手，直接输入序列码后提交，弹出对话框<br><img src="/2019/10/26/crackme001/0.png"><br>发现有字符串可查，嘿嘿嘿，第一道题嘛，直接智能搜索字符串，果然搜到，然后找到在程序中的位置后<br><img src="/2019/10/26/crackme001/0_1.png"><br>然后发现”Failed!”这些字符串是从jnz语句跳过去的,那肯定猜测这个跳转指令前面这个函数里有点东西,那么下断、步入这个CALL，进去后发现，其实也没什么东西。。。<br><img src="/2019/10/26/crackme001/1.png"><br>简单得像张纸一样,直接明文对比,相等的话就通过je语句跳转到这个CALL返回的地方,那这个时候爆破也可以,直接查看注册码也可以。<br><img src="/2019/10/26/crackme001/3.png"><br>可以看到,真正的序列码就是”Hello Dude!”.</p>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>接下来搞需要序列号和ID的。<br>同样的方法，利用程序提示错误的字符串进行搜索，发现有两处，我们分别下断，发现两处都有机会断下来.</p>
<h4 id="2-1"><a href="#2-1" class="headerlink" title="2-1"></a>2-1</h4><p>我猜这个程序应该是有两个判断的机制，可能一个是直接依据ID格式来，另一个才是真正地去匹配。<br>先看在前面的，<br><img src="/2019/10/26/crackme001/5.png"><br>惊喜地发现前面只是对ID的长度与4进行比较,如果大于等于的话就不会直接挂,那说明ID长度肯定是大于4的。</p>
<h4 id="2-2"><a href="#2-2" class="headerlink" title="2-2"></a>2-2</h4><p>接着继续看后面的，<br><img src="/2019/10/26/crackme001/4.png"><br>貌似这个思路和之前第一部分的思路是一样的,不相等就跳转,那肯定得看看这个跳转语句里面的内容了。同样的下断、步入，一进去就感觉离谱，里面怎么长这样：<br><img src="/2019/10/26/crackme001/1.png"><br>这不我刚刚才写的注释嘛,下断试一下,发现貌似这段被调用了N多次,先不管这么多,先把序列号搞出来再说。<br>继续跟下去,然后查看寄存器里面的值,发现此时的密码就在EAX里面,但是这样子就张得有点离谱<br><img src="/2019/10/26/crackme001/6.png"><br>猜测里面的数字应该是根据我输入的ID所生成的,又试了一次后发现果然是这样。现在要把程序生成密码的算法找出来。抓住密码存在EAX里面，我们可以往回找找。<br><img src="/2019/10/26/crackme001/7.png"><br>可以看到,这个函数是个fast_call,调用的两个参数就存在[local.4],[local.3]这两个变量中,其中前者是我们输入的序列号,后者是程序根据我们输入的ID生成的序列号。<br>再往前看点，我们发现突然出现了密码的前缀和后缀，分别是CW和CRACKED。<br><img src="/2019/10/26/crackme001/8.png"><br>那分别紧跟这这两个字符串的函数能有什么用,那肯定是拼接字符串了啊.既然能拼接字符串了,那么密码中间的部分肯定已经生成了吧,我们再往后看,发现出现了两个”-“,这不是密码中的间隔符号,嘛,那我们更加可以肯定密码是在这里完成拼接的了.那继续往前看,突然想起来我们之前不是发现了一个直接拿ID长度与4进行比较的跳转嘛,我们猜测密码是在跳转之后才生成的,毕竟你采取这样的方式跳转不就是为了提前判断ID是否有效嘛,如果ID都无效了,那还生成密码干什么嘛.<br>那我们先看看这两段之间的代码.<br><img src="/2019/10/26/crackme001/9.png"><br>通过信息窗口,我们发现local.4就是ID的信息<br><img src="/2019/10/26/crackme001/12.png"><br>然后查询内存,发现实际上就是取ID的第一个字节然后×上(00431750)这个地址里面双字长度的数<br><img src="/2019/10/26/crackme001/10.png"><br><img src="/2019/10/26/crackme001/11.png"><br>那么,通过查看之后,我们发现中间的数字就是通过取输入ID的前一个字×(0x29),然后再×2,最后转化为十进制就OK.<br><img src="/2019/10/26/crackme001/13.png">.<br>这个加密的算法就解出来了.经过测试后确实没错.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/10/linux_cmd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/10/linux_cmd/" itemprop="url">linux下常用指令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-10T22:00:20+08:00">
                2020-05-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="linux常用命令"><a href="#linux常用命令" class="headerlink" title="linux常用命令"></a>linux常用命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">1. 文件目录</span><br><span class="line">1.1 特殊符号: </span><br><span class="line">1.1.1 . 当前目录</span><br><span class="line">1.1.2 .. 上级目录</span><br><span class="line">1.1.3 ~ 用户的home目录</span><br><span class="line">1.2 cd - 切换目录</span><br><span class="line">1.3 ls - 查看目录&#x2F;文件属性</span><br><span class="line">1.4 mv&#x2F;cp&#x2F;rm 剪切&#x2F;拷贝&#x2F;删除文件</span><br><span class="line">1.5 rmdir 删除空目录</span><br><span class="line">1.6 touch 创建新文件</span><br><span class="line">1.7 查看文件内容 more(按页查看)&#x2F;less(部分查看)&#x2F;cat(查看全部)&#x2F;head(查看前x行)&#x2F;tail(查看后x行)</span><br><span class="line">1.8 hexdump 以十六进制查看文件</span><br><span class="line">    hexdump -C 文件名</span><br><span class="line">    hexdump -C 文件名 | less</span><br><span class="line">1.9 ln 创建文件链接</span><br><span class="line">1.10 file - 查看文件类型</span><br><span class="line">1.11 grep - 查找文件内容</span><br><span class="line">1.12 find&#x2F;whereis&#x2F;whois</span><br><span class="line">&lt;!-- more --&gt;</span><br><span class="line">2. 用户&#x2F;权限</span><br><span class="line">2.1 useradd(命令)&#x2F;adduser(脚本) 添加目录</span><br><span class="line">2.1 passwd 修改用户登陆密码</span><br><span class="line">2.3 userdel 删除用户</span><br><span class="line">2.4 usermod 修改用户信息(用户名&#x2F;主目录&#x2F;用户组&#x2F;登陆密码)</span><br><span class="line">2.4 chmod 修改文件权限</span><br><span class="line">2.5 chown 修改文件拥有者</span><br><span class="line">2.6 groupadd&#x2F;groupdel 添加用户组&#x2F;删除用户组</span><br><span class="line"> </span><br><span class="line">3. 进程&#x2F;任务</span><br><span class="line">3.1 ps&#x2F;top 查看当前进程信息</span><br><span class="line">3.2 kill 结束进程</span><br><span class="line"> </span><br><span class="line">4. 磁盘</span><br><span class="line">4.1 df&#x2F;du 查看磁盘使用信息</span><br><span class="line"> </span><br><span class="line">5. 其它</span><br><span class="line">    clear - 清屏</span><br><span class="line">    source - 强行让一个脚本去立即影响当前的环境(不重启而更新配置)</span><br><span class="line">    apt - 软件包管理</span><br><span class="line">    更新源 sudo apt update</span><br><span class="line">    更新软件 sudo apt upgrade</span><br><span class="line">    安装软件 : sudo apt install 软件名</span><br><span class="line">    卸载软件 : sudo apt remove &#x2F; sudo apt autoremove</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">6. 常见配置文件</span><br></pre></td></tr></table></figure>

<h3 id="GDB常用"><a href="#GDB常用" class="headerlink" title="GDB常用"></a>GDB常用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">1 命令行参数系列</span><br><span class="line">1.1 set args</span><br><span class="line">1.2 show args</span><br><span class="line"> </span><br><span class="line">2 运行系列</span><br><span class="line">2.1 r - 运行</span><br><span class="line">2.2 n - 单步步过(源码)</span><br><span class="line">2.3 s - 单步步入</span><br><span class="line">2.4 u - 运行到循环退出</span><br><span class="line">2.5 c - 继续运行</span><br><span class="line">2.6 si&#x2F;ni - 汇编级单步步入&#x2F;步过</span><br><span class="line">2.7 jump - 设置eip到指定位置</span><br><span class="line">2.8 finish 执行到当前函数返回</span><br><span class="line">2.9 回车键 重复执行上一指令</span><br><span class="line"> </span><br><span class="line">3 断点系列</span><br><span class="line">3.1 b 行号&#x2F;函数名 - 设置断点</span><br><span class="line">3.2 info b - 查看断点</span><br><span class="line">3.3 d 断点号 - 删除断点</span><br><span class="line">3.4 dis 断点号 - 禁用断点</span><br><span class="line">3.5 enable 断点号 - 启用断点</span><br><span class="line"> </span><br><span class="line">4 信息查看系列</span><br><span class="line">4.1 print 变量名 - 查看变量的值</span><br><span class="line">4.2 set 变量名&#x3D;VAL - 修改变量的值</span><br><span class="line">4.3 set disassembly-flavor intel 以intel方式查看反汇编</span><br><span class="line">4.4 list [函数名] - 查看源码</span><br><span class="line">4.5 backtrace 查看函数的调用的栈帧和层级关系,简写bt</span><br><span class="line">4.6 frame：切换函数的栈帧,简写f</span><br><span class="line">4.7 x命令</span><br><span class="line">    格式 x&#x2F;&lt;n&#x2F;f&#x2F;u&gt; &lt;addr&gt;</span><br><span class="line">    n是一个正整数，表示显示内存的长度，也就是说从当前地址向后显示几个地址的内容。</span><br><span class="line">    f 表示显示的格式，参见上面。如果地址所指的是字符串，那么格式可以是s，如果 地址是指令地址，那么格式可以是i。</span><br><span class="line">    u 表示从当前地址往后请求的字节数，如果不指定的话，GDB默认是4个bytes。u参数可以用下面的字符来代替，b表示单字节，h表示双字节，w表示四字 节，g表示八字节。当我们指定了字节长度后，GDB会从指内存定的内存地址开始，读写指定字节，并把其当作一个值取出来。</span><br><span class="line">    n&#x2F;f&#x2F;u三个参数可以一起使用。例如：</span><br><span class="line">    </span><br><span class="line">    命令：x&#x2F;3uh 0x54320 表示，从内存地址0x54320读取内容，h表示以双字节为一个单位，3表示三个单位，u表示按十六进制显示。</span><br><span class="line">    输出格式：</span><br><span class="line">	一般来说，GDB会根据变量的类型输出变量的值。但你也可以自定义GDB的输出的格式。例如，你想输出一个整数的十六进制，或是二进制来查看这个整型变量的中的位的情况。要做到这样，你可以使用GDB的数据显示格式：</span><br><span class="line"></span><br><span class="line">	x 按十六进制格式显示变量。</span><br><span class="line">	d 按十进制格式显示变量。</span><br><span class="line">	u 按十六进制格式显示无符号整型。</span><br><span class="line">	o 按八进制格式显示变量。</span><br><span class="line">	t 按二进制格式显示变量。</span><br><span class="line">	a 按十六进制格式显示变量。</span><br><span class="line">	c 按字符格式显示变量。</span><br><span class="line">	f 按浮点数格式显示变量。</span><br></pre></td></tr></table></figure>

<h3 id="ELF文件结构"><a href="#ELF文件结构" class="headerlink" title="ELF文件结构"></a>ELF文件结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">PE的组成</span><br><span class="line"> </span><br><span class="line">1. 头部</span><br><span class="line">   1.1 DOS头</span><br><span class="line">   1.2 NT头</span><br><span class="line">   1.2.1 文件头</span><br><span class="line">   1.2.2 扩展头</span><br><span class="line">   1.3 区段头</span><br><span class="line">2. 区段数据</span><br><span class="line">   2.1 代码段: .text</span><br><span class="line">   2.2 数据段: .data</span><br><span class="line">   2.3 只读数据段: .rdata</span><br><span class="line">   2.3.1 导入表的数据</span><br><span class="line">   2.3.2 导出表的数据</span><br><span class="line">   2.4 重定位数据段: .reloc </span><br><span class="line"> </span><br><span class="line">ELF文件格式</span><br><span class="line">ELF的组成部分</span><br><span class="line"> </span><br><span class="line">1. ELF头</span><br><span class="line">   1.1 id数组</span><br><span class="line">   1.1.1 前4位是魔数 0x74&quot;elf&quot;</span><br><span class="line">   1.1.2 ELF文件种类(32位&#x2F;64位)</span><br><span class="line">   1.1.3 ELF文件数据的字节序(小端&#x2F;大端)</span><br><span class="line">   1.1.4 版本 : 1. 文件版本,2. 系统ABI版本</span><br><span class="line">   1.2 文件类型 : 可重定位文件&#x2F;可执行文件&#x2F;动态库文件</span><br><span class="line">2. 程序头</span><br><span class="line">   2.1 段类型 : 决定了段的作用,以及段是否被加载到内存中. 一个ELF文件中,至少存在一个LOAD类型的段. ELF一般都有解释器段,这个段用于保存解释器的文件路径. 有可能也会存在动态链接段(用于链接外部模块)</span><br><span class="line">   2.2 段数据的文件偏移&#x2F;文件大小&#x2F;内存地址&#x2F;内存中的大小</span><br><span class="line">   2.3 加载到内存中后的分页属性</span><br><span class="line">   2.4 段的对齐粒度</span><br><span class="line">3. 区段头</span><br><span class="line">   3.1 区段名</span><br><span class="line">   3.2 区段类型</span><br><span class="line">   3.3 Link和info</span><br><span class="line">   3.4 区段数据的文件偏移和大小,元素大小.</span><br><span class="line">4. 区段数据</span><br><span class="line">   4.1 符号表</span><br><span class="line">   4.1.1 记录本模块的符号(导出)</span><br><span class="line">     记录在.symtab符号表中</span><br><span class="line">     记录一个符号的名字(例如函数名),记录了符号</span><br><span class="line">     的绑定类型(LOCAL,GLOBAL),还记录了符号的类型(函数,区段),记录符号的值(根据符号的不同,有不同的值,例如函数是符号类型,值就是函数的地址)</span><br><span class="line">   4.1.2 记录了导入的符号</span><br><span class="line">     记录在.dynsym符号表</span><br><span class="line">   4.2 重定位表</span><br><span class="line">   4.2.1 重定位类型, 决定了修复重定位的方法</span><br><span class="line">   可执行文件类型的ELF和共享库的ELF文件的重定位是不一样的.</span><br><span class="line">   4.2.2 重定位的偏移(根据重定位类型决定)</span><br><span class="line"> </span><br><span class="line">elf的加载</span><br><span class="line">do_execve();  </span><br><span class="line"> </span><br><span class="line">1. 其它</span><br><span class="line">   5.1 PLT和GOT表</span><br><span class="line">   call printf &#x3D;&#x3D;&gt; jmp [GOT表项地址] &#x3D;第二次以后&#x3D;&gt; printf真正的地址</span><br><span class="line">   ​             push XX</span><br><span class="line">   ​             jmp  xxx &#x3D;&#x3D;&gt; 加载printf所在的so文件,修复printf函数地址</span><br><span class="line">   ​            </span><br><span class="line"> </span><br><span class="line">2 构造函数数组,析构函数数组</span><br><span class="line">2.1 全局对象的初始化和析构.</span><br><span class="line">3 ptrace - 调试相关</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/reverse_data3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/reverse_data3/" itemprop="url">（转载）数据逆向分析(3)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T15:10:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>struct是由一系列具有相同类型或不同类型的数据构成的数据集合，也叫结构。它的实现方法上和数组是一样的，即每一个成员的访问是直接寻址方式。唯一的区别是，为了提高访问效率，成员无论类型为何，编译器将它们按照4字节对齐。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">eg：struct test</span><br><span class="line"></span><br><span class="line">       &#123;</span><br><span class="line"></span><br><span class="line">            char str;</span><br><span class="line"></span><br><span class="line">            int i;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">       test a&#x3D;&#123;&#39;A&#39;,0&#125;;</span><br><span class="line"></span><br><span class="line">debug:</span><br><span class="line"></span><br><span class="line">0041139E  mov         byte ptr [ebp-0Ch],41h &#x2F;&#x2F;4字节对齐</span><br><span class="line">004113A2  mov         dword ptr [ebp-8],0</span><br></pre></td></tr></table></figure>


<h4 id="同样的尴尬"><a href="#同样的尴尬" class="headerlink" title="同样的尴尬"></a>同样的尴尬</h4><p>和数组一样，直接从二进制代码上判断结构体边界，并且它比数组的判断更难。尤其是自定义结构体。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. struct TimeCount</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">     time_t Begin;</span><br><span class="line"></span><br><span class="line">     time_t End;</span><br><span class="line"></span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   TimeCount clock;&#x2F;&#x2F;很好的书写习惯</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">2. tme_t Begin,End;&#x2F;&#x2F;稍微懒一点</span><br><span class="line"></span><br><span class="line">3. time_t a[2];&#x2F;&#x2F;太恶劣了</span><br></pre></td></tr></table></figure>

<p>这三个声明是等价的，struct的界定应该说很多时候是非常随意的，但是以下情况是必须准确判断：</p>
<pre><code>1. 变量是结构体数组时，如果不想还原的代码，写满屏幕的话，嘿嘿...



2. 以指针形式在函数间传递时，好在这种情况很少是自定义结构体，这使得我们通常可以借助OD、IDA帮你判断。出现自定义结构体时，绝大多数情况又是队列、二叉树等等，只要经验足够的话是不难的。

3.4字节对齐产生数据空隙时，这么容易判断的时候，有便宜不占是白痴。</code></pre>
<h4 id="附上大佬的Blog链接"><a href="#附上大佬的Blog链接" class="headerlink" title="附上大佬的Blog链接"></a>附上大佬的Blog链接</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yangbostar/article/list/2">https://blog.csdn.net/yangbostar/article/list/2</a>?</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/reverse_data2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/reverse_data2/" itemprop="url">（转载）数据逆向分析(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T15:00:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>在C语言中，字符串是由字符组成，单字符不是字符串，至少有两个字符组成，且结尾字符是’/0’。</p>
<p>例如：”ABCD” 内存中实际储存结构是 41H 42H 43H 44H 00H</p>
<p>字符串的寻址，依靠首字节进行寄存器相对寻址方式：</p>
<p>例如：访问”ABCD”中的第二字节，byte ptr [ebx+1]</p>
<p>正是因为字符串的首字节索引的寻址方式，因此字符串往往要与指针配合。在C语言中常见的，</p>
<p>例如：char *str=“ABCD”；//mov [xxxx],offset string “ABCD”</p>
<p>另一种常见的方式，是将字符串放在数组里，需要首字节地址时，在数组名前加”&amp;”伪装成指针。当然，存在数组里的字符串，自然可以按照数组的访问方式，比如 直接寻址。</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>数组其实和普通变量没什么区别，每一个成员都是分别通过直接寻址方式访问。</p>
<p>但只有一种情况例外，并且十分常见，即当索引号为变量时，使用相对寻址方式。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char a[4]&#x3D;&#123;&#39;A&#39;,&#39;A&#39;,&#39;A&#39;,&#39;&#x2F;0&#39;&#125;;</span><br><span class="line">for(int i&#x3D;0;i&lt;3;i++)</span><br><span class="line">a[i]+&#x3D;1;</span><br></pre></td></tr></table></figure>
<p>对应反汇编：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">char a[4]&#x3D;&#123;&#39;A&#39;,&#39;A&#39;,&#39;A&#39;,&#39;&#x2F;0&#39;&#125;;</span><br><span class="line">0041139E  mov         byte ptr [a],41h</span><br><span class="line">004113A2  mov         byte ptr [ebp-7],41h</span><br><span class="line">004113A6  mov         byte ptr [ebp-6],41h</span><br><span class="line">004113AA  mov         byte ptr [ebp-5],0</span><br><span class="line"></span><br><span class="line">for(int i&#x3D;0;i&lt;3;i++)</span><br><span class="line">004113AE  mov         dword ptr [i],0</span><br><span class="line">004113B5  jmp         wmain+40h (4113C0h)</span><br><span class="line">004113B7  mov         eax,dword ptr [i]</span><br><span class="line">004113BA  add         eax,1</span><br><span class="line">004113BD  mov         dword ptr [i],eax</span><br><span class="line">004113C0  cmp         dword ptr [i],3</span><br><span class="line">004113C4  jge         wmain+5Ah (4113DAh)</span><br><span class="line"></span><br><span class="line">a[i]+&#x3D;1;</span><br><span class="line">004113C6  mov         eax,dword ptr [i]</span><br><span class="line">004113C9  movsx       ecx,byte ptr a[eax]</span><br><span class="line">004113CE  add         ecx,1</span><br><span class="line">004113D1  mov         edx,dword ptr [i]</span><br><span class="line">004113D4  mov         byte ptr [a+edx],cl ;反汇编器上常写为mov byte ptr a[edx],cl</span><br><span class="line">004113D8  jmp         wmain+37h (4113B7h)</span><br></pre></td></tr></table></figure>


<h3 id="数组的尴尬"><a href="#数组的尴尬" class="headerlink" title="数组的尴尬"></a>数组的尴尬</h3><p>除了源码调试，由于数组不标记边界，提通过数据初始化不能判断数组的始末位置<br>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int i&#x3D;0;</span><br><span class="line">int a[3]&#x3D;&#123;1,2,3&#125;;</span><br><span class="line"></span><br><span class="line">OD反汇编结果：</span><br><span class="line"></span><br><span class="line">00412FFE   MOV DWORD PTR SS:[EBP-8],   0</span><br><span class="line">00413005   MOV DWORD PTR SS:[EBP-1C], 1</span><br><span class="line">0041300C   MOV DWORD PTR SS:[EBP-18], 2</span><br><span class="line">00413013   MOV DWORD PTR SS:[EBP-14], 3</span><br></pre></td></tr></table></figure>

<p>显然，只看初始化我们很容易错误还原为 int a[4]={0,1,2,3};</p>
<p>因此数组的边界判断，需要后续代码流程的辅助，因为数组通常都是同一类操作的集合。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/reverse_data1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/reverse_data1/" itemprop="url">（转载）数据逆向分析(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T14:40:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>做数据逆向分析最先应该区分数据是常量、变量，还是指针。可是作为二进制数据本身不会标记自己是什么，然而编译器将不同的的类别储存在不同的区域。</p>
<h3 id="变量数据应分为这两类："><a href="#变量数据应分为这两类：" class="headerlink" title="变量数据应分为这两类："></a>变量数据应分为这两类：</h3><h4 id="1-局部非静态变量："><a href="#1-局部非静态变量：" class="headerlink" title="1. 局部非静态变量："></a>1. 局部非静态变量：</h4><p>对于1KB以下的该种变量，一般都要放在栈区，那么它的寻址必然用到ebp寄存器来间接变址进行寻址。另外，有些编译器（比如gcc）出于优化考虑，也会用到esp寄存器。</p>
<h5 id="举例："><a href="#举例：" class="headerlink" title="举例："></a>举例：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">void fun()</span><br><span class="line">&#123;</span><br><span class="line"> int i&#x3D;0;</span><br><span class="line"> char a[5]&#x3D;&quot;AAAA&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;vc2005Debug版反汇编</span><br><span class="line"></span><br><span class="line">void fun()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------保护寄存器数据</span><br><span class="line">00411390  push        ebp </span><br><span class="line">00411391  mov         ebp,esp</span><br><span class="line">00411393  sub         esp,0E0h</span><br><span class="line">00411399  push        ebx </span><br><span class="line">0041139A  push        esi </span><br><span class="line">0041139B  push        edi </span><br><span class="line"></span><br><span class="line">---------------------为局部变量在栈区预留内存，以及vc编译器的添加防溢出措施</span><br><span class="line"></span><br><span class="line">0041139C  lea         edi,[ebp-0E0h]</span><br><span class="line">004113A2  mov         ecx,38h</span><br><span class="line">004113A7  mov         eax,0CCCCCCCCh</span><br><span class="line">004113AC  rep stos    dword ptr es:[edi]</span><br><span class="line">004113AE  mov  eax,dword ptr [___security_cookie (417000h)] &#x2F;&#x2F;研究溢出漏洞的人，</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;可以看一下蓝色代码，</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;通过在回调地址前，</span><br><span class="line"></span><br><span class="line">                  	&#x2F;&#x2F;添加安全码</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;使shellcode不可以覆盖</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;这里，否则异常</span><br><span class="line">004113B3  xor           eax,ebp</span><br><span class="line">004113B5  mov         dword ptr [ebp-4],eax </span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;这是vs2005的新特性，</span><br><span class="line"></span><br><span class="line">                    &#x2F;&#x2F;你想能出破解方案吗？</span><br><span class="line"></span><br><span class="line">-------------------------------------------------</span><br><span class="line"></span><br><span class="line">int i&#x3D;0</span><br><span class="line"></span><br><span class="line">004113B8  mov         dword ptr [ebp-0Ch],0</span><br><span class="line"> char a[5]&#x3D;&quot;AAAA&quot;;</span><br><span class="line">004113BF  mov         eax,dword ptr [string &quot;AAAA&quot; (41563Ch)]</span><br><span class="line">004113C4  mov         dword ptr [ebp-1Ch],eax</span><br><span class="line">004113C7  mov         cl,byte ptr ds:[415640h]</span><br><span class="line">004113CD  mov         byte ptr [ebp-18h],cl</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">004113D0 push edx</span><br><span class="line">004113D1 mov ecx,ebp</span><br><span class="line">004113D3 push eax</span><br><span class="line">004113D4 lea edx,[ (4113F4h)]</span><br><span class="line">004113DA call @ILT+140(@_RTC_CheckStackVars@8) (411091h)</span><br><span class="line">004113DF pop eax</span><br><span class="line">004113E0 pop edx</span><br><span class="line">004113E1 pop edi</span><br><span class="line">004113E2 pop esi</span><br><span class="line">004113E3 pop ebx</span><br><span class="line">004113E4 mov ecx,dword ptr [ebp-4]</span><br><span class="line">004113E7 xor ecx,ebp</span><br><span class="line">004113E9 call @ILT+25(@__security_check_cookie@4) (41101Eh)</span><br><span class="line">004113EE mov esp,ebp</span><br><span class="line">004113F0 pop ebp</span><br><span class="line">004113F1 ret  </span><br></pre></td></tr></table></figure>

<h4 id="2-全局变量、局部静态变量："><a href="#2-全局变量、局部静态变量：" class="headerlink" title="2. 全局变量、局部静态变量："></a>2. 全局变量、局部静态变量：</h4><p>它们统一储存在数据节，因为它们的实现方式是一样的，都是直接寻址方式来寻址，只是全局变量，在所有区域均可访问，而局部静态变量只能在函数内部访问。</p>
<h5 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">char a[5]&#x3D;&quot;AAAA&quot;;</span><br><span class="line">void fun()</span><br><span class="line">&#123;</span><br><span class="line"> static int i;</span><br><span class="line"> i&#x3D;0;</span><br><span class="line"> a[0]&#x3D;&#39;b&#39;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> void fun()</span><br><span class="line">&#123;</span><br><span class="line">00411390  push        ebp </span><br><span class="line">00411391  mov         ebp,esp</span><br><span class="line">00411393  sub         esp,0C0h</span><br><span class="line">00411399  push        ebx </span><br><span class="line">0041139A  push        esi </span><br><span class="line">0041139B  push        edi </span><br><span class="line">0041139C  lea         edi,[ebp-0C0h]</span><br><span class="line">004113A2  mov         ecx,30h</span><br><span class="line">004113A7  mov         eax,0CCCCCCCCh</span><br><span class="line">004113AC  rep stos    dword ptr es:[edi] &#x2F;&#x2F;由于没有使用堆栈，编译器没有添加防溢出措施</span><br><span class="line"> static int i;</span><br><span class="line"> i&#x3D;0;</span><br><span class="line">004113AE  mov         dword ptr [41719Ch],0</span><br><span class="line"> a[0]&#x3D;&#39;b&#39;;</span><br><span class="line">004113B8  mov         byte ptr [417034h],62h </span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">004113BF pop edi</span><br><span class="line">004113C0 pop esi</span><br><span class="line">004113C1 pop ebx</span><br><span class="line">004113C2 mov esp,ebp</span><br><span class="line">004113C4 pop ebp</span><br><span class="line">004113C5 ret</span><br></pre></td></tr></table></figure>




<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>常量和全局变量、静态变量实现方法使一样的，使用直接寻址，但区别是：只能读、不可写。<br>比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. mov eax, [417034h]</span><br><span class="line"></span><br><span class="line">2. cmp eax, [417034h]</span><br></pre></td></tr></table></figure>


<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>指针可以当做是存储地址的变量，它即可以是全局变量，也可以是局部非静态变量，但与普通变量的区别是:”初始化时使用offset或lea，使用指向内容时二次寻址”。</p>
<p>举例：初始化：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.mov [417034h],offset “AAAA”&#x2F;&#x2F;全局指针</span><br><span class="line"></span><br><span class="line">2.lea   eax,ARRAY</span><br><span class="line"></span><br><span class="line">  mov [esp-4ch],eax&#x2F;&#x2F;局部指针</span><br><span class="line"></span><br><span class="line">使用：</span><br><span class="line"></span><br><span class="line">1.mov eax, [417034h]</span><br><span class="line"></span><br><span class="line">  mov edx, [eax]</span><br><span class="line"></span><br><span class="line">2.mov eax, [esp-4ch]</span><br><span class="line"></span><br><span class="line">  mov edx, [eax+i]&#x2F;&#x2F;指针可能指向的是数组</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;vc2005Debug版反汇编</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/19/ce_tg3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/19/ce_tg3/" itemprop="url">CE Tutorial Games--3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-19T14:20:20+08:00">
                2019-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="CE-Tutorial-Games"><a href="#CE-Tutorial-Games" class="headerlink" title="CE Tutorial Games"></a>CE Tutorial Games</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/18/jmp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/18/jmp/" itemprop="url">跳转指令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-18T20:44:39+08:00">
                2019-10-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>为了防止遗忘，以及为了日后查找方便，记录一下跳转指令的条件以及其意义</p>
<h3 id="跳转指令"><a href="#跳转指令" class="headerlink" title="跳转指令"></a>跳转指令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ja 大于时跳转</span><br><span class="line">jae 大于等于</span><br><span class="line">jb 小于</span><br><span class="line">jbe 小于等于</span><br><span class="line">je 相等</span><br><span class="line">jna 不大于</span><br><span class="line">jnae 不大于或者等于</span><br><span class="line">jnb 不小于</span><br><span class="line">jnbe 不小于或等于</span><br><span class="line">jne 不等于</span><br><span class="line">jg 大于(有符号)</span><br><span class="line">jge 大于等于(有符号)</span><br><span class="line">jl 小于(有符号)</span><br><span class="line">jle 小于等于(有符号)</span><br><span class="line">jng 不大于(有符号)</span><br><span class="line">jnge 不大于等于(有符号)</span><br><span class="line">jnl 不小于</span><br><span class="line">jnle 不小于等于</span><br><span class="line">jns 无符号</span><br><span class="line">jnz 非零</span><br><span class="line">js 如果带符号</span><br><span class="line">jz 如果为零</span><br></pre></td></tr></table></figure>

<p>发生跳转时各标志寄存器的值<br><img src="/2019/10/18/jmp/1.png"></p>
<p>以及对应的指令字母的含义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a: above</span><br><span class="line">e: equal</span><br><span class="line">b: below</span><br><span class="line">n: <span class="keyword">not</span></span><br><span class="line">g: greater</span><br><span class="line">l: lower</span><br><span class="line">s: signed</span><br><span class="line">z: zero</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/16/ce_tg2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/16/ce_tg2/" itemprop="url">CE Tutorial Games--2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-16T19:00:20+08:00">
                2019-10-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##<br>参照文档：<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-915447-1-1.html">https://www.52pojie.cn/thread-915447-1-1.html</a><br>开始CE Tutorial Game 第三关的再次尝试。</p>
<h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>2D游戏就两个坐标，按照52某牛的说法，2D游戏一般是左负右正，上下的正负不一定。</p>
<p>先利用CE搜索到人物的坐标。首先选到单浮点数和未知初始值，多次移动人物再加上多次搜索后就可以确定一个值了，这个就是我们要找的横坐标。<br><img src="/2019/10/16/ce_tg2/1.png" alt="1"><br>这时候修改这个横坐标的值就可以让人物进行瞬移了.<br>配合上上篇Blog里修改变绿台阶数为12即可过关.<br>现在我们来找一下任务的纵坐标.<br>一般横纵坐标的值应该都放在同一个地方,所以我们可以试下查看横坐标在内存中的相邻区域.<br><img src="/2019/10/16/ce_tg2/2.png" alt="2"><br>然后选择以浮点方式查看内存,接着让人物跳跃、移动,就可以发现两个可疑数据<br><img src="/2019/10/16/ce_tg2/3.png" alt="3"><br>观察数据变化可以发现,横坐标在屏幕内的范围从左到右是(-1,1),纵坐标在屏幕内的变化范围从上到下是(-1,1)</p>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>接下来试下找到游戏里面的重力系统.</p>
<h4 id="2-1"><a href="#2-1" class="headerlink" title="2-1"></a>2-1</h4><p>重力可以改变纵坐标的值,所以我们查看下是什么改变纵坐标的值.<br><img src="/2019/10/16/ce_tg2/4.png" alt="4"><br>发现有两个指令对其进行修改,其中有一条指令在人物跳起来时不会写入数据.<br>猜测应该是第一条对纵坐标进行了修改.<br>进入内存查看,剔除掉和纵坐标无关的指令,剩下的代码由52大牛整理如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gtutorial-x86_64.exe+4048D - 48 8B 43 28           - mov rax,[rbx+28]</span><br><span class="line">gtutorial-x86_64.exe+40491 - F3 44 0F10 40 28      - movss xmm8,[rax+28] &#123; 读取 Y 坐标 &#125;</span><br><span class="line">gtutorial-x86_64.exe+40497 - 48 8B 43 28           - mov rax,[rbx+28]</span><br><span class="line">gtutorial-x86_64.exe+4049B - F3 0F5A 48 28         - cvtss2sd xmm1,[rax+28] &#123; 再次读取 Y 坐标 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404A0 - F3 0F5A 53 78         - cvtss2sd xmm2,[rbx+78] &#123; 读取 Y 速度 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404A5 - F2 0F2A C6            - cvtsi2sd xmm0,esi &#123; esi 是毫秒数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404A9 - F2 0F5E 05 AF382400   - divsd xmm0,[gtutorial-x86_64.exe+283D60] &#123; 除以 1000 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404B1 - F2 0F59 C2            - mulsd xmm0,xmm2 &#123; 速度乘时间 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404B5 - F2 0F5C C8            - subsd xmm1,xmm0 &#123; Y 坐标减去位移 &#125;</span><br><span class="line">gtutorial-x86_64.exe+404B9 - F2 44 0F5A C9         - cvtsd2ss xmm9,xmm1 &#123; double 转 float &#125;</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">gtutorial-x86_64.exe+40506 - F3 44 0F11 48 28      - movss [rax+28],xmm9 &#123; 赋值给 [rax+28] &#125;</span><br></pre></td></tr></table></figure>

<p>感觉整个分析过程就是要甄别出真正有效的数据,然后找出他们的内在逻辑.</p>
<p>纵坐标的地址可以很容易找出: <code>[[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+28]+28</code>(他这里好像写错了)<br>根据分析,速度地址应该是 <code>[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+78</code><br>手动添加地址后我们就可以直接修改速度了,但是这个速度会变化,所以我们可以设置热键,让速度分别变为1和-1,这样就可以比较好地进行控制.<br>根据同样的道理,水平方向的速度我们也可以进行更改.</p>
<h4 id="2-2"><a href="#2-2" class="headerlink" title="2-2"></a>2-2</h4><p>这次来找重力加速度.<br>重力加速度会直接影响竖直方向上的速度,我们直接查看什么修改了竖直方向上的速度.<br><img src="/2019/10/16/ce_tg2/5.png" alt="5"><br>发现只有第二条指令会一直对速度修改,所以在内存中查看第二条指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gtutorial-x86_64.exe+40709 - F3 0F5A 43 78         - cvtss2sd xmm0,[rbx+78] &#123; 读取速度 &#125;</span><br><span class="line">gtutorial-x86_64.exe+4070E - F2 0F5C 05 52362400   - subsd xmm0,[gtutorial-x86_64.exe+283D68] &#123; 减去 0.1 &#125;</span><br><span class="line">gtutorial-x86_64.exe+40716 - F2 0F5A C0            - cvtsd2ss xmm0,xmm0 &#123; double 转 float &#125;</span><br><span class="line">gtutorial-x86_64.exe+4071A - F3 0F11 43 78         - movss [rbx+78],xmm0 &#123; 写入速度 &#125;</span><br></pre></td></tr></table></figure>
<p>这个机制蛮简单的,每次速度减0.1.</p>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>这次来找敌人的位置.<br>只要找到敌人的横坐标,它们的地址+4就是他们的纵坐标了.和搜索自己的坐标方法类似,很快可以搜索到他们的坐标.<br>直接锁定他们坐标的值,发现可以锁定,但是当12个台阶都亮起时,他们还是会飞去守门.<br>这时候查看什么对它们进行了写入,借用大牛的图:<br><img src="/2019/10/16/ce_tg2/6.png" alt="6"><br>直接将第五条指令nop掉,就可以对他们的坐标进行修改了.</p>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>这次来查找开门的指令.<br>开门和已经变绿的台阶数量有关系,那么我们先查看有什么访问了这个变量.<br>查看后发现只有一条指令堆积访问,于是查看它在内存中的位置,发现有几个有意思的判断:(还是摘自大牛整理的代码)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gtutorial-x86_64.exe+4098B - 48 63 93 88000000     - movsxd  rdx,dword ptr [rbx+00000088] &#123; 读取已变绿平台数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+40992 - 48 8B 43 30           - mov rax,[rbx+30]</span><br><span class="line">gtutorial-x86_64.exe+40996 - 48 85 C0              - test rax,rax</span><br><span class="line">gtutorial-x86_64.exe+40999 - 74 08                 - je gtutorial-x86_64.exe+409A3</span><br><span class="line">gtutorial-x86_64.exe+4099B - 48 8B 40 F8           - mov rax,[rax-08] &#123; [rax-08] 为平台数组最大下标 &#125;</span><br><span class="line">gtutorial-x86_64.exe+4099F - 48 83 C0 01           - add rax,01 &#123; 最大下标 + 1 即为总平台数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409A3 - 48 39 C2              - cmp rdx,rax &#123; 比较已变绿平台数和总平台数 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409A6 - 7C 17                 - jl gtutorial-x86_64.exe+409BF</span><br><span class="line">gtutorial-x86_64.exe+409A8 - 48 8B 43 60           - mov rax,[rbx+60] &#123; 二级指针 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409AC - C6 40 18 00           - mov byte ptr [rax+18],00 &#123; 开门 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409B0 - C6 43 7D 01           - mov byte ptr [rbx+7D],01 &#123; 堵门 &#125;</span><br><span class="line">gtutorial-x86_64.exe+409B4 - 48 8B 43 68           - mov rax,[rbx+68]</span><br><span class="line">gtutorial-x86_64.exe+409B8 - 48 89 83 80000000     - mov [rbx+00000080],rax</span><br><span class="line">gtutorial-x86_64.exe+409BF - 48 83 7B 28 00        - cmp qword ptr [rbx+28],00 &#123; 0 &#125;</span><br></pre></td></tr></table></figure>

<p>这里可以看到总台阶数并没有存在哪个变量里,而是由数组下标+1来表示.<br>我们可以推导出开门地址<code> [[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+60]+18</code><br>以及<code>[[&quot;gtutorial-x86_64.exe&quot;+37DC50]+760]+7D</code><br>这样直接修改开门地址为0,堵门地址也为0就可以过关了.</p>
<h4 id="内容太多了-下一篇Blog再来写破解碰撞检测的方法"><a href="#内容太多了-下一篇Blog再来写破解碰撞检测的方法" class="headerlink" title="内容太多了,下一篇Blog再来写破解碰撞检测的方法."></a>内容太多了,下一篇Blog再来写破解碰撞检测的方法.</h4>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/14/ce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hughes'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/14/ce/" itemprop="url">初学CheatEngine的使用(内含CE Tutorial Games--1）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-14T15:00:20+08:00">
                2019-10-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learning/" itemprop="url" rel="index">
                    <span itemprop="name">learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="CheatEngine"><a href="#CheatEngine" class="headerlink" title="CheatEngine"></a>CheatEngine</h2><p>很早就接触过了CE修改器，当时是玩一些幼稚小游戏，然后用ce修改器修改金币和经验。不过也仅仅是接触，从来没有深入过，这次CNSS招新有道贪食蛇的题目(wtcl,还没写出来)，可以用CE调试,我就准备学下CE调试,然后刚刚好它有几个教程,这篇blog就来写下写CE教程题目的经历.<br>总共分为两部分,一个是Cheat Engine Tutorial,另一个是Cheat Engine Tutorial Games.</p>
<h2 id="Cheat-Engine-Tutorial"><a href="#Cheat-Engine-Tutorial" class="headerlink" title="Cheat Engine Tutorial"></a>Cheat Engine Tutorial</h2><p>这部分非常基础,然后基本上就是CE的基本用法.<br>第一关到第八关有手就行,然后第九关有一个点我没接触过,这里记录下来.<br>第九关是个小游戏,敌我双方各两个人,但是敌人伤害高血还厚,我们打不过,而过关的条件就是把敌人乃一组特.(如图)<br><img src="/2019/10/14/ce/1p.png" alt="第九关"><br>首先肯定是搜索血量,很容易搜到四个人的血量的地址.然后F6,查看是什么改写这个地址.查看之后发现改写的时候调用的是同一个函数(如图).</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/10/14/ce/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&lt;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hughlhz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:hughes_lhz@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://sup3rgate.xyz/" title="Supergate" target="_blank">Supergate</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://47.95.203.90/" title="Weihongtao" target="_blank">Weihongtao</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hujiekang.top/" title="Hujiekang" target="_blank">Hujiekang</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://106.54.80.67/" title="Centrix" target="_blank">Centrix</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://47.100.137.92/" title="CjDuan" target="_blank">CjDuan</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.pushrbp.com" title="Cool" target="_blank">Cool</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
